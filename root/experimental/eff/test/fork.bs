use experimental:eff;
use test;

effect Fork {
	unsafe effect void fork();
}

handler ForkHandler for Fork {
	handle fork(), k {
		k.call();
		k.call();
	}
}

suite ForkTest {
	Counter before;
	Counter after;

	handle ForkHandler {
		// print("Before");
		before.count++;
		Fork:fork();
		// print("After");
		after.count++;
	};

	test before.count == 1;
	test after.count == 2;
}
