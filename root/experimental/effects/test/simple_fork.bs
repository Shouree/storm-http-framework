use experimental:effects;
use test;

unsafe effect void simpleFork(Nat times);

handler SimpleFork for simpleFork(Nat t), k {
	for (Nat i = 0; i < t; i++)
		k.call();
}


suite SimpleForkTest {
	Counter before;
	Counter after;

	handle SimpleFork {
		before.count++;
		simpleFork(3);
		after.count++;
	}

	test before.count == 1;
	test after.count == 3;
}
